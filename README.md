# study_api_famous_quotes

### 公開URL
https://xs278795.xsrv.jp/study_api_famous_quotes/
### 作成日
2024/7/10～7/25 
### 内容
世界の著名人たちの言葉をランダムに表示するだけのアプリです
### 作った目的
勉強用としてFecth APIを使ったアプリを一度自分で作ってみたかった。
Node.jsを使ったプロダクトを公開する予定のため、その前に、Node.js環境下でこの作品を作り、デプロイまでを予行演習として行いたかった。
### 大変だったこと
～ APIについて　～
- 今回使ったAPIはAPI keyが発行されなかっただったからか、try～catchの型をイメージすると、思ってたほど難しくはなかった。
### 作品が完成したあとのほうが大変だった。
～ 本番環境での作業にて ～
- サーバーのGLIBCのVerの関係でプロダクトのNode.jsのVer（最新バージョン）を受け付けないという謎の課題に直面。
`Node.jsのバージョンをv20.11.1からv18.17.0に変更`した。開発環境下ではプログラムは問題なく動いた。
- （続報）レンタルサーバー会社にNode.jsの新しいバージョンが使えないことを伝え、GLIBCのバージョン更新の要望メールを送ったが、遠回しに対応できないとの回答でガックリ来た。＿|￣|○
- サーバーのpublicディレクトリには通常、Node.jsで作ったアプリは配置しないとのことで、その為に何をすべきかについての設定にかなり時間がかかった。
- 次に起こった問題は、開発の時にはうまくいっていたfetch処理が、本番環境下ではうまくいかなかった。原因が数日間わからずかなりやられた。結局エンドポイントの問題であることが分かった。それは確かにそうだ、開発の時は同じディレクトリ内でHTTPのreq,resは完結するが、実際はユーザーのブラウザからインターネット経由でエンドポイントにHTTP送信されなければいけないので、そのイメージができてなかった。

### 作ってみた感想
～ Fetch APIについて ～
- まずはAPI処理のための型を覚えようと思った。

～ 本番環境への移行作業について ～
- ローカル→リモートリポジトリ→サーバーまでの流れをgitで一通りできたことは良かった。
- プロダクトをサーバーに配置する際に、**.env**と **.gitignore**が非常に重要だったことが分かった。
- Node.jsアプリを本番環境で動かすのは、思ってたのとはまったく違ってかなり大変だった。コードができたらよかったではなかった。サーバー側の知識と知識もそれ以上に知っておかなければいけない。これからも大変な気がする。

### 開発記録:
-   { 
        date:   '2024/7/10',
        content:    '作成開始'
    },
-  {
		date:   '2024/7/11　～　7/18',
		content:    '本番環境よりpm2 start、もしくはpm2 restarでnode.jsを実行すると必ず他のプロセスが同じポートを使用中とのメッセージ出現でエラーになる。他のプロセスは使ってないが、Node.jsを実行した瞬間に他のプロセスが出現する謎のエラーに苦しんだ。
		この問題解決にほぼ１週間費やした。徹夜作業が2日あった。'
	},
-  {
		date:   '2024/7/19',
		content:    '翌日パソコン立ち上げてpm2を叩く、エラーが消えていた。
		そして公開URLでアクセスするとトップページが見れた。
		しかしなぜ見れるようになったのか、またなぜ今まで他のプロセスというものが立ち上がっていたのか、最後まで原因がわからずモヤモヤが残ったまま、とりあえず次の段階へいくことにする'
    },
-  {
		date:	'2024/7/21～7/25',
		content:	'開発環境では正常に動いていたAPIが、本番環境ではうまくいかなかった。ここが一番大変だった。
		エンドポイントがうまく読めてないところまで分かり、あとはいろんなパターンのパス名で試し、最後うまく動いたという流れだった。'
},
-  {
		date: '2024/7/24～7/25',
		content: '検索ボタンを押してないのに勝手にエラーメッセージがコンソール出力されるという現象が続いた。'}
		
		```
		Uncaught (in promise) Error: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received
		at onMessage (extensions::messaging:192:13)
		```
-  {
		date: '2024/7/24～7/25',
		content: '時間の経過で何度も発生し続ける。
		コードのエラーかとビビっていたが、どうもGoogle Chromeの拡張機能が関係してるらしいという事を知った。
		試しに怪しそうだったAvira Browser Safetyをオフにするとエラーメッセージが発生しなくなった。
		これがエラーメッセージの原因だったということか。とりあえずホッとした。
		'}
